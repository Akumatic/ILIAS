/**
 * This file is part of ILIAS, a powerful learning management system
 * published by ILIAS open source e-Learning e.V.
 *
 * ILIAS is licensed with the GPL-3.0,
 * see https://www.gnu.org/licenses/gpl-3.0.en.html
 * You should have received a copy of said license along with the
 * source code, too.
 *
 * If this is not the case or you just want to try ILIAS, you'll find
 * us at:
 * https://www.ilias.de
 * https://github.com/ILIAS-eLearning
 */
!function(e,t){"use strict";function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=a(e),i=a(t);i.default.WOPI={},i.default.WOPI.windowResize=function(e){const t=e.parentElement.offsetWidth-0,a=n.default.getElementsByClassName("il-layout-page-content")[0].clientHeight-n.default.getElementsByClassName("il_HeaderInner")[0].clientHeight-n.default.getElementsByTagName("footer")[0].clientHeight-100;e.setAttribute("width",t),e.setAttribute("height",a)},i.default.WOPI.postMessage=function(e){this.editorFrameWindow.postMessage(JSON.stringify(e),"*")},i.default.WOPI.save=function(){this.postMessage({MessageId:"Action_Save",SendTime:Date.now(),Values:{DontTerminateEdit:!0,DontSaveIfUnmodified:!0,Notify:!1}})},i.default.WOPI.init=function(){
// BUILD IFRAME
const e=n.default.getElementById("c-embedded-wopi"),t=e.getAttribute("data-token"),a=e.getAttribute("data-editor-url"),d=e.getAttribute("data-ttl"),s=n.default.createElement("iframe");
// read ttl, token and editor URL from data attributes
s.name="editor_frame",s.id="editor_frame",s.title="Office Frame",s.setAttribute("allowfullscreen","true"),s.setAttribute("frameBorder","0"),e.appendChild(s),this.windowResize(s),
// eslint-disable-next-line max-len
this.editorFrameWindow=s.contentWindow||s.contentDocument.document||s.contentDocument;
// BUILD FORM
const o=n.default.createElement("form"),l=n.default.createElement("input"),u=n.default.createElement("input");o.method="POST",o.action=a,o.target="editor_frame",l.name="access_token",l.value=t,o.appendChild(l),u.name="access_token_ttl",u.value=d,o.appendChild(u),n.default.body.appendChild(o),
// SEND FORM
o.submit(),
// Add event listener to receive messages from the editor
window.addEventListener("message",(e=>{const t=JSON.parse(e.data);"App_LoadingStatus"===t.MessageId&&"Document_Loaded"===t.Values.Status&&this.postMessage({MessageId:"Host_PostmessageReady",SendTime:Date.now(),Values:{}})}),!1),
// Add event listener to resize the editor iframe
n.default.defaultView.addEventListener("resize",(()=>{i.default.WOPI.windowResize(s)}))}}(document,il);
