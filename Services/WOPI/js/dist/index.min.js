/**
 * This file is part of ILIAS, a powerful learning management system
 * published by ILIAS open source e-Learning e.V.
 *
 * ILIAS is licensed with the GPL-3.0,
 * see https://www.gnu.org/licenses/gpl-3.0.en.html
 * You should have received a copy of said license along with the
 * source code, too.
 *
 * If this is not the case or you just want to try ILIAS, you'll find
 * us at:
 * https://www.ilias.de
 * https://github.com/ILIAS-eLearning
 */
!function(e,t,a){"use strict";function i(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=i(e),d=i(a);d.default.WOPI={},d.default.WOPI.windowResize=function(e){const t=e.parentElement.offsetWidth-20,a=n.default.getElementsByClassName("il-layout-page-content")[0].clientHeight-n.default.getElementsByClassName("il_HeaderInner")[0].clientHeight-100;e.setAttribute("width",t),e.setAttribute("height",a)},d.default.WOPI.init=function(){
// BUILD IFRAME
const e=n.default.getElementById("c-embedded-wopi"),t=e.getAttribute("data-token"),a=e.getAttribute("data-editor-url"),i=e.getAttribute("data-ttl"),l=n.default.createElement("iframe");
// read ttl, token and editor URL from data attributes
l.name="editor_frame",l.id="editor_frame",l.title="Office Frame",l.setAttribute("allowfullscreen","true"),l.setAttribute("frameBorder","0"),e.appendChild(l),this.windowResize(l);
// BUILD FORM
const u=n.default.createElement("form"),r=n.default.createElement("input"),f=n.default.createElement("input");u.method="POST",u.action=a,u.target="editor_frame",r.name="access_token",r.value=t,u.appendChild(r),f.name="access_token_ttl",f.value=i,u.appendChild(f),n.default.body.appendChild(u),
// SEND FORM
u.submit(),n.default.defaultView.addEventListener("resize",(()=>{d.default.WOPI.windowResize(l)}))}}(document,window,il);
